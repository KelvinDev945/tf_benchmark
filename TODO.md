# TODO - TensorFlow Benchmark å¾…åŠäº‹é¡¹

**æœ€åæ›´æ–°**: 2025-11-08 (Issue #1 å·²ä¿®å¤)

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§ - é˜»å¡æ€§é—®é¢˜

### 1. ä¿®å¤ TensorFlow Engine ç±»å‹æ£€æŸ¥é”™è¯¯

**æ–‡ä»¶**: `src/engines/tensorflow_engine.py:84-102`

**é—®é¢˜æè¿°**:
```
Invalid model_path type: TFBertForSequenceClassification.
Expected str or tf.keras.Model
```

**æ ¹æœ¬åŸå› **: 
- HuggingFace çš„ `TFBertForSequenceClassification` ä¸æ˜¯ `tf.keras.Model` çš„ç›´æ¥å®ä¾‹
- å½“å‰ä»£ç ä½¿ç”¨ `isinstance(model_path, tf.keras.Model)` æ£€æŸ¥å¤±è´¥
- Transformers æ¨¡å‹è™½ç„¶åŸºäº Kerasï¼Œä½†æœ‰è‡ªå·±çš„åŸºç±»

**ä¿®å¤æ–¹æ¡ˆ**:
```python
# ä¿®æ”¹ src/engines/tensorflow_engine.py ç¬¬84è¡Œ
# åŸä»£ç :
if isinstance(model_path, tf.keras.Model):

# æ”¹ä¸º:
if hasattr(model_path, '__call__') and hasattr(model_path, 'predict'):
    # æ¥å—ä»»ä½•å¯è°ƒç”¨çš„ TensorFlow æ¨¡å‹ï¼ˆKeras æˆ– Transformersï¼‰
```

**å½±å“**: ğŸ”´ é˜»å¡æ‰€æœ‰ TensorFlow ç›¸å…³çš„ BERT æµ‹è¯•

**çŠ¶æ€**: âœ… å·²ä¿®å¤

**ä¿®å¤è¯¦æƒ…**:
- **æäº¤**: 894d3ba
- **æ—¥æœŸ**: 2025-11-08
- **ä¿®æ”¹å†…å®¹**:
  - å°†ç±»å‹æ£€æŸ¥ä» `isinstance(model_path, tf.keras.Model)` æ”¹ä¸º `hasattr(model_path, '__call__') and hasattr(model_path, 'predict')`
  - è°ƒæ•´æ£€æŸ¥é¡ºåºï¼šå…ˆæ£€æŸ¥å­—ç¬¦ä¸²è·¯å¾„ï¼Œå†æ£€æŸ¥æ¨¡å‹å¯¹è±¡
  - æ”¹è¿›é”™è¯¯æ¶ˆæ¯ï¼Œæ˜¾ç¤ºå®é™…çš„ç±»å‹åç§°
  - æ·»åŠ æ¨¡å‹ç±»å‹åˆ°æˆåŠŸæ—¥å¿—ä»¥ä¾¿è°ƒè¯•
- **æµ‹è¯•è„šæœ¬**: `scripts/test_tf_engine_fix.py` (çº¯ TensorFlow/Keras æµ‹è¯•)

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ - åŠŸèƒ½é—®é¢˜

### 2. ä¿®å¤ TFLite INT8 é‡åŒ–è½¬æ¢é”™è¯¯

**æ–‡ä»¶**: `src/models/model_converter.py` æˆ–ç›¸å…³è½¬æ¢ä»£ç 

**é—®é¢˜æè¿°**:
```
TFLite conversion failed: object of type 'function' has no len()
```

**æ ¹æœ¬åŸå› **:
- TFLite é‡åŒ–éœ€è¦ representative dataset generator
- ä»£ç ä¼ å…¥äº†å‡½æ•°å¯¹è±¡ï¼Œä½†æŸå¤„å°è¯•è·å–å…¶é•¿åº¦
- å¯èƒ½æ˜¯ generator å‡½æ•°ä½¿ç”¨ä¸æ­£ç¡®

**éœ€è¦è°ƒæŸ¥**:
- [ ] æ£€æŸ¥ representative dataset çš„å®ç°
- [ ] ç¡®è®¤ generator å‡½æ•°çš„æ­£ç¡®ç”¨æ³•
- [ ] æŸ¥çœ‹ TFLite è½¬æ¢ä»£ç ä¸­çš„æ•°æ®æ ¼å¼è¦æ±‚

**å½±å“**: ğŸŸ¡ å½±å“ INT8 é‡åŒ–æ¨¡å‹æµ‹è¯•

**çŠ¶æ€**: âŒ æœªä¿®å¤

---

### 3. è§£å†³ ONNX Runtime NumPy å…¼å®¹æ€§é—®é¢˜

**æ–‡ä»¶**: ONNX è½¬æ¢ç›¸å…³ä»£ç 

**é—®é¢˜æè¿°**:
```
module 'numpy' has no attribute 'object'.
`np.object` was a deprecated alias for the builtin `object`.
```

**æ ¹æœ¬åŸå› **:
- NumPy 1.20+ åºŸå¼ƒäº† `np.object` åˆ«å
- tf2onnx æˆ–ç›¸å…³åº“ä½¿ç”¨äº†è¿‡æ—¶çš„ NumPy API
- ç¯å¢ƒä¸­çš„ NumPy ç‰ˆæœ¬è¾ƒæ–°ï¼Œä¸ tf2onnx ä¸å…¼å®¹

**å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ**:
1. æ›´æ–° tf2onnx åˆ°æœ€æ–°ç‰ˆæœ¬
2. é™çº§ NumPy ç‰ˆæœ¬åˆ° < 1.20ï¼ˆå¯èƒ½å½±å“å…¶ä»–åŒ…ï¼‰
3. ä½¿ç”¨ monkey patch ä¸´æ—¶ä¿®å¤

**å½±å“**: ğŸŸ¡ å½±å“ ONNX Runtime æµ‹è¯•

**çŠ¶æ€**: âŒ æœªä¿®å¤

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§ - ä¼˜åŒ–å’Œå¢å¼º

### 4. æ·»åŠ æ›´å¤šæ¨¡å‹æ”¯æŒ

- [ ] GPT ç³»åˆ—æ¨¡å‹
- [ ] T5 æ¨¡å‹
- [ ] Vision Transformer (ViT)
- [ ] ç›®æ ‡æ£€æµ‹æ¨¡å‹ (YOLO, SSD)

### 5. æ€§èƒ½ä¼˜åŒ–

- [ ] æ·»åŠ æ‰¹å¤„ç†ä¼˜åŒ–
- [ ] å®ç°å¤šçº¿ç¨‹å¹¶è¡Œæµ‹è¯•
- [ ] æ·»åŠ æ¨¡å‹ç¼“å­˜æœºåˆ¶
- [ ] ä¼˜åŒ–æ•°æ®åŠ è½½æµç¨‹

### 6. æŠ¥å‘Šå¢å¼º

- [ ] æ·»åŠ äº¤äº’å¼å›¾è¡¨ (Plotly)
- [ ] æ”¯æŒ PDF å¯¼å‡º
- [ ] æ·»åŠ å†å²å¯¹æ¯”åŠŸèƒ½
- [ ] ç”Ÿæˆ CI/CD é›†æˆæŠ¥å‘Š

### 7. æ–‡æ¡£æ”¹è¿›

- [ ] æ·»åŠ æ›´å¤šä½¿ç”¨ç¤ºä¾‹
- [ ] åˆ›å»ºè§†é¢‘æ•™ç¨‹
- [ ] æ·»åŠ æœ€ä½³å®è·µæŒ‡å—
- [ ] å®Œå–„ API æ–‡æ¡£

---

## ğŸ”§ CI/CD è‡ªåŠ¨åŒ–

### 10. GitHub Actions Workflow é›†æˆ

#### 10.1 åŸºç¡€ CI/CD Workflow âœ… é«˜ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆpytestï¼‰
- [ ] ç”Ÿæˆä»£ç è¦†ç›–ç‡æŠ¥å‘Šï¼ˆpytest-covï¼‰
- [ ] å¤š Python ç‰ˆæœ¬æµ‹è¯•çŸ©é˜µï¼ˆ3.11, 3.12ï¼‰
- [ ] åœ¨ PR å’Œ push åˆ°ä¸»åˆ†æ”¯æ—¶è‡ªåŠ¨è§¦å‘
- [ ] ä¸Šä¼ è¦†ç›–ç‡æŠ¥å‘Šåˆ° Codecov/Coveralls

**è§¦å‘æ¡ä»¶**:
- Push to main/develop branches
- Pull requests

**é¢„æœŸæ•ˆæœ**:
- æ¯æ¬¡æäº¤è‡ªåŠ¨éªŒè¯ä»£ç è´¨é‡
- é˜²æ­¢ç ´åæ€§æ›´æ”¹åˆå¹¶åˆ°ä¸»åˆ†æ”¯
- å¿«é€Ÿåé¦ˆï¼ˆ< 5åˆ†é’Ÿï¼‰

---

#### 10.2 ä»£ç è´¨é‡æ£€æŸ¥ Workflow âœ… é«˜ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] Black ä»£ç æ ¼å¼åŒ–æ£€æŸ¥
- [ ] Flake8 è¯­æ³•å’Œé£æ ¼æ£€æŸ¥
- [ ] isort import æ’åºæ£€æŸ¥
- [ ] mypy ç±»å‹æ³¨è§£æ£€æŸ¥
- [ ] åœ¨ PR ä¸­æ·»åŠ ä»£ç è´¨é‡æŠ¥å‘Šæ³¨é‡Š

**å·¥å…·é…ç½®**:
- ä½¿ç”¨é¡¹ç›®ä¸­å·²æœ‰çš„ blackã€flake8ã€isortã€mypy
- é…ç½®æ–‡ä»¶ï¼špyproject.toml æˆ– setup.cfg

**å¯é€‰åŠŸèƒ½**:
- [ ] è‡ªåŠ¨ä¿®å¤æ ¼å¼é—®é¢˜å¹¶æäº¤ï¼ˆé€šè¿‡ botï¼‰
- [ ] ä»£ç è´¨é‡è¯„åˆ†å’Œè¶‹åŠ¿åˆ†æ

---

#### 10.3 ä¾èµ–å®‰å…¨æ£€æŸ¥ Workflow ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] æ‰«æ requirements.txt ä¸­çš„å®‰å…¨æ¼æ´
- [ ] ä½¿ç”¨ pip-audit æˆ– safety å·¥å…·
- [ ] å®šæœŸæ£€æŸ¥ï¼ˆæ¯å‘¨ä¸€æ¬¡ + æ¯æ¬¡æ›´æ–°ä¾èµ–æ—¶ï¼‰
- [ ] å‘ç°æ¼æ´æ—¶åˆ›å»º Issue æˆ–å‘é€é€šçŸ¥

**æ£€æŸ¥é¡¹ç›®**:
- requirements.txt
- å·²çŸ¥ CVE æ•°æ®åº“
- è¿‡æ—¶çš„åŒ…ç‰ˆæœ¬

**å¥½å¤„**:
- åŠæ—¶å‘ç°ä¾èµ–åŒ…çš„å®‰å…¨é—®é¢˜
- ä¿æŒé¡¹ç›®å®‰å…¨æ€§
- ç¬¦åˆå®‰å…¨æœ€ä½³å®è·µ

---

#### 10.4 Docker é•œåƒæ„å»ºæµ‹è¯• ğŸŸ¡ ä¸­ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] éªŒè¯ Dockerfile èƒ½æˆåŠŸæ„å»º
- [ ] æµ‹è¯•æ„å»ºçš„é•œåƒèƒ½æ­£å¸¸è¿è¡Œ
- [ ] å¤šå¹³å°æ„å»ºæµ‹è¯•ï¼ˆx86_64, ARM64ï¼‰
- [ ] å¯é€‰ï¼šæ¨é€åˆ° Docker Hub æˆ– GitHub Container Registry
- [ ] é•œåƒå¤§å°å’Œå±‚æ•°ä¼˜åŒ–æ£€æŸ¥

**ç›¸å…³æ–‡ä»¶**:
- docker/Dockerfile
- scripts/build_images.sh

**æ„å»ºç­–ç•¥**:
- PR: ä»…éªŒè¯æ„å»º
- Main branch: æ„å»ºå¹¶æ¨é€åˆ° registry
- Tags: åˆ›å»ºå‘å¸ƒç‰ˆæœ¬é•œåƒ

---

#### 10.5 é›†æˆæµ‹è¯• Workflow ğŸŸ¢ ä½-ä¸­ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] è¿è¡Œæ ‡è®°ä¸º `@pytest.mark.integration` çš„æµ‹è¯•
- [ ] è¿è¡Œæ ‡è®°ä¸º `@pytest.mark.slow` çš„é•¿æ—¶é—´æµ‹è¯•
- [ ] ä½¿ç”¨æ›´å¤§çš„ runnerï¼ˆéœ€è¦æ›´å¤š CPU/å†…å­˜ï¼‰
- [ ] å®šæœŸè¿è¡Œï¼ˆæ¯æ—¥/æ¯å‘¨ï¼‰è€Œä¸æ˜¯æ¯æ¬¡ commit
- [ ] å¯é€‰ï¼šåœ¨äº‘ç«¯è¿è¡Œå®Œæ•´çš„ benchmark æµ‹è¯•

**æµ‹è¯•ç±»å‹**:
- æ•°æ®é›†åŠ è½½æµ‹è¯•ï¼ˆéœ€è¦ç½‘ç»œä¸‹è½½ï¼‰
- æ¨¡å‹åŠ è½½å’Œè½¬æ¢æµ‹è¯•
- ç«¯åˆ°ç«¯ benchmark è¿è¡Œæµ‹è¯•

**è¿è¡Œæ—¶é—´é¢„ä¼°**:
- é›†æˆæµ‹è¯•ï¼š10-30 åˆ†é’Ÿ
- å®Œæ•´ benchmarkï¼š1-6 å°æ—¶ï¼ˆæ ¹æ®é…ç½®ï¼‰

---

#### 10.6 æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ ğŸŸ¢ ä½ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼ˆSphinx æˆ– MkDocsï¼‰
- [ ] éƒ¨ç½²åˆ° GitHub Pages
- [ ] éªŒè¯ README å’Œæ–‡æ¡£ä¸­çš„ç¤ºä¾‹ä»£ç 
- [ ] æ£€æŸ¥æ–‡æ¡£é“¾æ¥æœ‰æ•ˆæ€§
- [ ] ç”Ÿæˆ changelog

**æ–‡æ¡£ç±»å‹**:
- API å‚è€ƒæ–‡æ¡£
- ç”¨æˆ·æŒ‡å—
- å¼€å‘è€…æ–‡æ¡£
- ç¤ºä¾‹å’Œæ•™ç¨‹

---

#### 10.7 æ€§èƒ½åŸºå‡†æµ‹è¯•å’Œå›å½’æ£€æµ‹ ğŸŸ¢ ä½ä¼˜å…ˆçº§

**åŠŸèƒ½**:
- [ ] å®šæœŸè¿è¡Œ benchmark å¹¶è®°å½•ç»“æœ
- [ ] æ¯”è¾ƒä¸åŒç‰ˆæœ¬çš„æ€§èƒ½å˜åŒ–
- [ ] ç”Ÿæˆæ€§èƒ½è¶‹åŠ¿å›¾è¡¨
- [ ] æ£€æµ‹æ€§èƒ½é€€åŒ–ï¼ˆè¶…è¿‡é˜ˆå€¼æ—¶å‘Šè­¦ï¼‰
- [ ] å°†ç»“æœå‘å¸ƒåˆ° GitHub Pages

**åŸºå‡†æµ‹è¯•åœºæ™¯**:
- Quick mode benchmarkï¼ˆæ¯æ¬¡ PRï¼‰
- Standard mode benchmarkï¼ˆæ¯æ—¥ï¼‰
- Full mode benchmarkï¼ˆæ¯å‘¨ï¼‰

**æ€§èƒ½æŒ‡æ ‡**:
- å»¶è¿Ÿï¼ˆP50/P95/P99ï¼‰
- ååé‡
- å†…å­˜ä½¿ç”¨
- CPU åˆ©ç”¨ç‡

---

### å®æ–½ä¼˜å…ˆçº§å»ºè®®

**ç¬¬ä¸€é˜¶æ®µï¼ˆæœ¬å‘¨ï¼‰**:
1. åŸºç¡€ CI/CD Workflowï¼ˆæœ€é‡è¦ï¼‰
2. ä»£ç è´¨é‡æ£€æŸ¥ Workflow

**ç¬¬äºŒé˜¶æ®µï¼ˆæœ¬æœˆï¼‰**:
3. ä¾èµ–å®‰å…¨æ£€æŸ¥
4. Docker é•œåƒæ„å»ºæµ‹è¯•

**ç¬¬ä¸‰é˜¶æ®µï¼ˆå¯é€‰ï¼‰**:
5. é›†æˆæµ‹è¯• Workflow
6. æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
7. æ€§èƒ½åŸºå‡†æµ‹è¯•

---

## ğŸ“ æŠ€æœ¯å€ºåŠ¡

### 8. ä»£ç è´¨é‡æ”¹è¿›

- [ ] å¢åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡åˆ° 90%+
- [ ] æ·»åŠ é›†æˆæµ‹è¯•
- [ ] å®Œå–„é”™è¯¯å¤„ç†
- [ ] æ·»åŠ æ›´å¤šç±»å‹æ³¨è§£

### 9. é…ç½®ç®¡ç†

- [ ] æ”¯æŒé…ç½®æ–‡ä»¶æ¨¡æ¿
- [ ] æ·»åŠ é…ç½®éªŒè¯å™¨
- [ ] æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
- [ ] æ·»åŠ é…ç½®è¿ç§»å·¥å…·

---

## ğŸ› å·²çŸ¥é—®é¢˜ï¼ˆéé˜»å¡ï¼‰

### PyTorch ä¾èµ–é—®é¢˜

**è¯´æ˜**:
åœ¨æŸæ¬¡è¿è¡Œä¸­çœ‹åˆ°ï¼š
```
Loading a PyTorch model in TensorFlow, requires both PyTorch and TensorFlow to be installed.
âœ— TensorFlow baseline benchmark failed: No module named 'torch'
```

**è§£å†³æ–¹æ¡ˆ**:
- HuggingFace æ¨¡å‹å°è¯•ä» PyTorch æƒé‡è½¬æ¢
- é€šè¿‡è®¾ç½® `from_pt=False` å’Œ `use_safetensors=False` å¯ä»¥å¼ºåˆ¶ä½¿ç”¨ TF æƒé‡
- æˆ–é¢„å…ˆè½¬æ¢æ¨¡å‹ä¸º TensorFlow SavedModel æ ¼å¼

**å½±å“**: ä»…å½±å“æŸäº› HuggingFace æ¨¡å‹

---

### SafeTensors æ ¼å¼å…¼å®¹æ€§

**è¯´æ˜**:
å¦ä¸€æ¬¡è¿è¡Œçœ‹åˆ°ï¼š
```
âœ— TensorFlow baseline benchmark failed: 'builtins.safe_open' object is not iterable
```

**è§£å†³æ–¹æ¡ˆ**:
- ä½¿ç”¨ `model.safetensors` æ—¶å¯èƒ½å‡ºç°å…¼å®¹æ€§é—®é¢˜
- å»ºè®®ä½¿ç”¨ `tf_model.h5` æ ¼å¼ï¼ˆå·²åœ¨ä»£ç ä¸­è®¾ç½®ï¼‰

**å½±å“**: ä»…å½±å“ç‰¹å®šæ¨¡å‹æ ¼å¼

---

## âœ… æœ€è¿‘å®Œæˆ

- [x] ç²¾ç®€é¡¹ç›®æ–‡æ¡£ï¼ˆä» 12 ä¸ªå‡å°‘åˆ° 3 ä¸ªï¼‰
- [x] åˆå¹¶ TODO å†…å®¹åˆ° README.md
- [x] åˆ›å»º BERT ä¸“é¡¹æµ‹è¯•æ¡†æ¶
- [x] æ·»åŠ ç»¼åˆæŠ¥å‘Šç”Ÿæˆå·¥å…·
- [x] å®ç°å®Œæ•´çš„ benchmark æµç¨‹

---

## ğŸ“‹ æµ‹è¯•ç¯å¢ƒä¿¡æ¯

- **TensorFlow ç‰ˆæœ¬**: 2.20.0
- **Python ç‰ˆæœ¬**: 3.11
- **Docker é•œåƒ**: tf-cpu-benchmark:latest
- **æµ‹è¯•æ¨¡å‹**: google-bert/bert-base-uncased
- **æµ‹è¯•æ•°æ®é›†**: glue/sst2 (validation split)

---

## ğŸ¯ è¿‘æœŸç›®æ ‡

1. **æœ¬å‘¨**: ä¿®å¤ TensorFlow Engine ç±»å‹æ£€æŸ¥é—®é¢˜ï¼ˆIssue #1ï¼‰
2. **æœ¬æœˆ**: è§£å†³æ‰€æœ‰é‡åŒ–å’Œ ONNX ç›¸å…³é—®é¢˜
3. **ä¸‹æœˆ**: æ·»åŠ æ›´å¤šæ¨¡å‹æ”¯æŒå’Œæ€§èƒ½ä¼˜åŒ–

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [README.md](README.md) - é¡¹ç›®ä¸»æ–‡æ¡£
- [PROJECT_COMPLETE.md](PROJECT_COMPLETE.md) - å®Œæ•´é¡¹ç›®æ–‡æ¡£
- [BERT_BENCHMARK_GUIDE.md](BERT_BENCHMARK_GUIDE.md) - BERT ä½¿ç”¨æŒ‡å—

---

**ç»´æŠ¤è€…**: è¯·å®šæœŸæ›´æ–°æ­¤æ–‡æ¡£ï¼Œæ ‡è®°å·²å®Œæˆçš„ä»»åŠ¡ âœ…

